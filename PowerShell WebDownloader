#Generated Form Function
function GenerateForm {
########################################################################
# Code Generated By: SAPIEN Technologies PrimalForms (Community Edition) v1.0.10.0
# Generated On: 03.12.2020 13:36
# Generated By: MarcGeiger
########################################################################

#region Import the Assemblies
[reflection.assembly]::loadwithpartialname("System.Windows.Forms") | Out-Null
[reflection.assembly]::loadwithpartialname("System.Drawing") | Out-Null
#endregion

#region Generated Form Objects
$form1 = New-Object System.Windows.Forms.Form
$btn_help = New-Object System.Windows.Forms.Button
$txt_filedestination = New-Object System.Windows.Forms.Label
$txb_link = New-Object System.Windows.Forms.TextBox
$drp_filedestination = New-Object System.Windows.Forms.DomainUpDown
$txt_link = New-Object System.Windows.Forms.Label
$btn_cancel = New-Object System.Windows.Forms.Button
$btn_start = New-Object System.Windows.Forms.Button
$InitialFormWindowState = New-Object System.Windows.Forms.FormWindowState


#endregion Generated Form Objects

#----------------------------------------------
#Generated Event Script Blocks
#----------------------------------------------
#Provide Custom Code for events specified in PrimalForms.
$handler_label1_Click= 
{
#TODO: Place custom script here

}

$handler_txb_link_Leave= 
{
#TODO: Place custom script here

}


$btn_help_click=
{
Start-Process notepad.exe 'C:\Users\MarcGeiger\Desktop\TBZ\Modul 122\GUI 1\HELP.txt'
} 

$drp_filedestination_click= 
{
#TODO: Place custom script here

}

$handler_txb_link_Enter= 
{



}

$btn_cancel_click= 
{
$btn_cancel.Add_Click( { #Funktion die beim Tastenklick ausgeführt werden soll:
    $script:answer = "Cancel"; #Rückgabevariable mit Text füllen
    $form1.close() #Fenster schliessen lassen
} )

}

$handler_label2_Click= 
{
#TODO: Place custom script here

}

$handler_domainUpDown1_SelectedItemChanged= 
{
#TODO: Place custom script here

}

$btn_start_click=
{
$web = New-Object -typename Net.Webclient   #download wird gestartet             
write-host $txb_link.text
$web.downloadfile($txb_link.text, $drp_filedestination.SelectedItem) #startet den donwnload und legt den speicher ort fest
cls
Write-Host "Your Picture has been downloaded. Thanks for using this downloader!"
Start-Process $drp_filedestination.SelectedItem
}

$OnLoadForm_StateCorrection=
{#Correct the initial state of the form to prevent the .Net maximized form issue
	$form1.WindowState = $InitialFormWindowState


}

#----------------------------------------------
#region Generated Form Code
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 200
$System_Drawing_Size.Width = 550
$form1.ClientSize = $System_Drawing_Size
$form1.DataBindings.DefaultDataSourceUpdateMode = 0
$form1.Name = "form1"
$form1.Text = "Pic Downloader"


$btn_help.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 28
$System_Drawing_Point.Y = 126
$btn_help.Location = $System_Drawing_Point
$btn_help.Name = "btn_help"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 23
$btn_help.Size = $System_Drawing_Size
$btn_help.TabIndex = 6
$btn_help.Text = "?"
$btn_help.UseVisualStyleBackColor = $True
$btn_help.add_Click($btn_help_click)

$form1.Controls.Add($btn_help)

$txt_filedestination.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 28
$System_Drawing_Point.Y = 62
$txt_filedestination.Location = $System_Drawing_Point
$txt_filedestination.Name = "txt_filedestination"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 171
$txt_filedestination.Size = $System_Drawing_Size
$txt_filedestination.TabIndex = 5
$txt_filedestination.Text = "Choose your file destination:"
$txt_filedestination.add_Click($handler_label2_Click)

$form1.Controls.Add($txt_filedestination)

$txb_link.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 184
$System_Drawing_Point.Y = 19
$txb_link.Location = $System_Drawing_Point
$txb_link.Name = "txb_link"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 240
$txb_link.Size = $System_Drawing_Size
$txb_link.TabIndex = 4
$txb_link.add_Leave($handler_txb_link_Leave)
$txb_link.add_Enter($handler_txb_link_Enter)

$form1.Controls.Add($txb_link)

$drp_filedestination.DataBindings.DefaultDataSourceUpdateMode = 0
$drp_filedestination.Items.Add("C:\Users\MarcGeiger\Downloads\bild.jpg")|Out-Null
$drp_filedestination.Items.Add("C:\Users\MarcGeiger\Desktop\bild.jpg")|Out-Null
$drp_filedestination.Items.Add("C:\Users\MarcGeiger\Pictures\bild.jpg")|Out-Null
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 184
$System_Drawing_Point.Y = 60
$drp_filedestination.Location = $System_Drawing_Point
$drp_filedestination.Name = "drp_filedestination"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 20
$System_Drawing_Size.Width = 240
$drp_filedestination.Size = $System_Drawing_Size
$drp_filedestination.TabIndex = 3
$drp_filedestination.add_SelectedItemChanged($handler_domainUpDown1_SelectedItemChanged)
$drp_filedestination.add_Click($drp_filedestination_click)

$form1.Controls.Add($drp_filedestination)

$txt_link.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 28
$System_Drawing_Point.Y = 22
$txt_link.Location = $System_Drawing_Point
$txt_link.Name = "txt_link"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 208
$txt_link.Size = $System_Drawing_Size
$txt_link.TabIndex = 2
$txt_link.Text = "Enter the URL of your Picture:"
$txt_link.add_Click($handler_label1_Click)

$form1.Controls.Add($txt_link)


$btn_cancel.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 268
$System_Drawing_Point.Y = 126
$btn_cancel.Location = $System_Drawing_Point
$btn_cancel.Name = "btn_cancel"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 75
$btn_cancel.Size = $System_Drawing_Size
$btn_cancel.TabIndex = 1
$btn_cancel.Text = "Cancel"
$btn_cancel.UseVisualStyleBackColor = $True
$btn_cancel.add_Click($btn_cancel_click)

$form1.Controls.Add($btn_cancel)


$btn_start.DataBindings.DefaultDataSourceUpdateMode = 0

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 349
$System_Drawing_Point.Y = 126
$btn_start.Location = $System_Drawing_Point
$btn_start.Name = "btn_start"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 75
$btn_start.Size = $System_Drawing_Size
$btn_start.TabIndex = 0
$btn_start.Text = "Start"
$btn_start.UseVisualStyleBackColor = $True
$btn_start.add_Click($btn_start_click)

$form1.Controls.Add($btn_start)

#endregion Generated Form Code

#Save the initial state of the form
$InitialFormWindowState = $form1.WindowState
#Init the OnLoad event to correct the initial state of the form
$form1.add_Load($OnLoadForm_StateCorrection)
#Show the Form
$form1.ShowDialog()| Out-Null

} #End Function

#Call the Function
GenerateForm
